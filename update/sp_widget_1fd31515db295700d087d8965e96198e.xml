<?xml version="1.0" encoding="UTF-8"?>
<record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function(cabrillo, $http, $location, $scope) {
	/* widget controller */
	var c = this;
	//Captures current user's first name
	c.currentUser = $scope.user.first_name;
	//Used to determine if in the mobile app or not
	c.isNative = cabrillo.isNative();
	//Holds the asset identifier.  Passed in from manual input.
	c.serialNumber = "";
	//Show/hide the manual input form
	c.showForm = false;
	//Show/hide the main home screen layout 
	c.showHomeButtons = true;
	//Holds the response from the getAsset API call
	c.asset = '';
	//Set to true or false based on if there is an error
	c.error = false;
	//Holds the error message if there is an error
	c.errorMessage = "";
	
	// Client side access to camera scan through the Cabrillo library.  Called when user clicks on Scan Button.  
	//URL goes to Scanned Information widget, and camera appends the asset identifier to the URL
	c.scan = function(){
		cabrillo.camera.getBarcode().then(function(barcode) {
			if (barcode){
				window.location.href = 'asset_scan?id=scanned_information&serial_no=' + barcode;
			}else{
				c.error = true;
				c.errorMessage = "Try Again";
			}
		}, function(error) {
			c.error = true;
			c.errorMessage = "Unable to scan.";
		});
	};
	
	//Sets up the URL to go to the Scanned Information widget with the identifier from the input field
	c.manualSubmit = function(serialNumber){
		window.location.href = '/asset_scan?id=scanned_information&serial_no=' + serialNumber;
	};
	
	//User clicks on the Manual Input button from the home screen.  
	//This changes the HTML to hide the home screen and show the manual form
	c.showManualInput = function(){
		//Show the input field and label
		c.showForm = true;
		//Hide Get Started Header and the Scanning button 
		c.showHomeButtons = false;
		//Add hash to URL
		var manualHash = $location.hash("manual-hash");
		//Hide error message if already loaded
		c.error = false;
	};
	
	//User clicks the Cancel button. Change the page back to the main home screen.
	c.goHome = function() {
		c.showForm = false;
		c.showHomeButtons = true;
		var homeHash = $location.hash('');
	};
	
}]]></client_script>
        <controller_as>c</controller_as>
        <css>//Error Message
.error-message {
  z-index: 999;
  margin-top: 10px;
  position: absolute;
}

//General Buttons Styling

button {
  font-size: 20px;
  border: none;
}

.button-icon {
  display: block;
  margin: 0 auto;
}

.white-button {
  background-color: #ffffff;
}

a .white-button{
  color: inherit;
}

//Manual Entry Form
#serial-number-form {
  font-size: 15px;
  height: 100vh;
  background: #ffffff;
}

//Manual Entry
.manual-submit-cancel-row {
	padding: 0;
  margin-top: 15%;
}
.manual-submit-cancel {
	width: 100%;
  height: 70px;
}

.cancel-button {
   background-color: #ffffff;
   color: #007bff;
   border: 1px solid #eeeeee 
}

.submit-button {
   background-color: #005EB8;
   color: #ffffff;
}

//Main Homepage 
.home-div {
  background: linear-gradient(#00B2EE 150px, 150px, #A9A9A9);
  height: 100vh;
}

.home-title {
	padding-bottom: 20px; 
}

.home-label {
  color: #ffffff;
}

.home-screen-row {
  margin: 0 auto;
  padding: 7px;
}

//Start Scanning Button
.start-scanning-button {
  height: 150px;
}

#barcode-icon {
  height: 75px;
}

//Small button
.small-button {
	height: 70px;
}

.small-icon {
  width: 30px;
}

.small-button-text {
  font-size: 15px;
}

//Inventory Check Button
.inventory-check-button {
	height: 90px;  
}

a.button-link:link,  a.button-link:visited{
	 text-decoration: inherit;
   color: inherit;
   cursor: auto;
}
a.button-link:hover {
  color: black;
}

//Add Asset Button
#plus-icon {
 font-size: 35px;
 display: block;
 color: #717171;
}

//Home Nav
.navbar {
	min-height: 0 !important;  
}

.bottom-nav {
	background-color: #fff;
  border-top: 1px solid #ccc;
  height: 10px;
}

.navbar-fixed-bottom {
	bottom: 30px; 
}

.bottom-nav ul {
	padding: 0;
}

.bottom-nav li {
	padding: 0;
}

.home-menu {
  position: absolute;
  bottom: 0;
}

.navbar-nav {
  margin: 0 !important;
}

.navbar-nav li a {
 line-height: 15px !important; 
 padding: 5px 0 !important;
}
</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>asset-scanner</id>
        <internal>false</internal>
        <link/>
        <name>Asset Scanner</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {  /* populate the 'data' object */  /* e.g., data.table = $sp.getValue('table'); */})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>212607632</sys_created_by>
        <sys_created_on>2018-04-17 15:17:59</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>1fd31515db295700d087d8965e96198e</sys_id>
        <sys_mod_count>279</sys_mod_count>
        <sys_name>Asset Scanner</sys_name>
        <sys_package display_value="Asset Scanning" source="x_gege9_asset_scan">7be151dddbe55700d087d8965e9619c8</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Asset Scanning">7be151dddbe55700d087d8965e9619c8</sys_scope>
        <sys_update_name>sp_widget_1fd31515db295700d087d8965e96198e</sys_update_name>
        <sys_updated_by>212606938</sys_updated_by>
        <sys_updated_on>2018-08-07 19:00:18</sys_updated_on>
        <template><![CDATA[<!-- Main Homepage -->
<div id="home-screen">
  <div class="container-fluid">
    <div class="row">
      
      <!-- Error message -->
      <div class="alert alert-danger col-xs-8 col-xs-offset-2 error-message" ng-show="c.error">
        {{c.errorMessage}}
      </div>
      
      <!-- Manual Entry Form -->
      <div class="form-group" id="serial-number-form" ng-show="c.showForm">
        <div class="col-xs-10 col-xs-offset-1">
        	<h4 class="text-center">Manually Enter Barcode</h4>
          <label class="control-label">Barcode information</label>
          <input type="text" id="serialInput" placeholder="Enter Serial Number" ng-model="c.serialNumber" class="form-control" autofocus />
        </div>
        <div>
          <div class="col-xs-4 col-xs-offset-1 manual-submit-cancel-row">
            <button class="btn manual-submit-cancel cancel-button" ng-click="c.goHome()">
              CANCEL
            </button>
          </div>
          <div class="col-xs-4 col-xs-offset-2 manual-submit-cancel-row">
            <button class="btn manual-submit-cancel submit-button" ng-click="c.manualSubmit(c.serialNumber)">
              SUBMIT
            </button>
          </div>
        </div>
      </div>
      
      <!-- Main Homepage -->
      <div class="home-div" ng-show="c.showHomeButtons">
        <div class="col-xs-12 home-title">
          <h3 class="text-center home-label" id="get-started-label">Welcome {{c.currentUser}},</h3>
          <h4 class="text-center home-label" id="get-started-label">How do you want to get started today?</h4>
        </div>
        <div class="home-buttons">
          <div class="row home-screen-row" id="scan-button-row">
            <button class="btn col-xs-8 col-xs-offset-2 start-scanning-button white-button" ng-click="c.scan()">
              <img class="button-icon" id="barcode-icon" src="barcode-icon.png" />Scan
            </button>
          </div>
          <div class="row home-screen-row">
            <button class="btn col-xs-8 col-xs-offset-2 small-button white-button" ng-click="c.showManualInput()">
              <img class="button-icon small-icon" src="pencil-icon.png"/>
              <span class="small-button-text">Manual Input</span>
            </button>
          </div>
          <div class="row home-screen-row">
            <a href="/asset_scan?id=inventory" class="button-link">
              <button class="btn col-xs-8 col-xs-offset-2 small-button white-button">
                <img class="button-icon small-icon" src="inventory.svg"/>
                <span class="small-button-text">Inventory</span>
              </button>
            </a>
          </div>

          <div class="row home-screen-row">
            <a href="/asset_scan?id=add_new_asset" class="button-link">
              <button class="btn col-xs-8 col-xs-offset-2 small-button white-button">
                <img class="button-icon small-icon" src="plus.svg"/>
                <span class="small-button-text">Add New Assets</span>
              </button>
            </a>
          </div>

        </div>
      </div>
      
    </div>
  </div>
</div>

<!-- Home Nav -->
<div class="navbar navbar-fixed-bottom bottom-nav" ng-show="c.showForm">
  <div class="container-fluid">
    <ul class="nav navbar-nav col-xs-12">
      <li class="text-center center-block col-xs-12">
        <a href="/asset_scan"><i class="glyphicon glyphicon-home"></i>
          <p>
            Home
          </p>
        </a>
      </li>
    </ul>
  </div>
  <!--<button ng-show="c.loaded" class="col-xs-12 btn btn-primary" ng-click="c.navigate('asset_scan')">Back to Scan</button>-->
</div>

<!-- Show if not in native mobile app -->
<div ng-hide="c.isNative">
  <p>You must be in the ServiceNow mobile app.</p>
</div>]]></template>
    </sp_widget>
</record_update>
